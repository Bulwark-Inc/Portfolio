{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
  <section class="max-w-4xl mx-auto px-4 py-12">
    
    <!-- Blog Title -->
    <h1 class="text-3xl sm:text-4xl font-bold mb-4">{{ blog.title }}</h1>
    <p class="text-gray-500 text-sm mb-6">Published on {{ blog.created_at|date:"F d, Y" }}</p>

    <!-- Featured Image -->
    {% if blog.image %}
      <img src="{{ blog.image.url }}" alt="{{ blog.title }}" class="w-full rounded-lg shadow mb-6">
    {% endif %}

    <!-- Blog Content -->
    <div class="prose prose-lg dark:prose-invert max-w-none mb-12">
      {{ blog.content|linebreaks }}
    </div>

    <!-- Comments Section -->
    <div class="mb-12">
      <h2 class="text-2xl font-semibold mb-4">Comments</h2>
      
      {% if comments %}
        <ul class="space-y-6">
          {% for comment in comments %}
            <li class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
              <p class="font-semibold text-gray-800 dark:text-white mb-1">{{ comment.name }}</p>
              <p class="text-gray-600 dark:text-gray-300 text-sm mb-2">{{ comment.created_at|date:"F j, Y, g:i a" }}</p>
              <p class="text-gray-700 dark:text-gray-200">{{ comment.message }}</p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-500">No comments yet. Be the first to comment.</p>
      {% endif %}
    </div>

    <!-- Comment Form -->
    <div>
      <h2 class="text-2xl font-semibold mb-4">Leave a Comment</h2>

      {% if messages %}
        {% for message in messages %}
          <div class="bg-green-100 text-green-800 p-4 rounded mb-4">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}

      <form method="post" class="space-y-4">
        {% csrf_token %}
        <div>
          {{ form.name.label_tag }}
          {{ form.name|add_class:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded" }}
          {% if form.name.errors %}
            <p class="text-red-500 text-sm">{{ form.name.errors.0 }}</p>
          {% endif %}
        </div>

        <div>
          {{ form.email.label_tag }}
          {{ form.email|add_class:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded" }}
          {% if form.email.errors %}
            <p class="text-red-500 text-sm">{{ form.email.errors.0 }}</p>
          {% endif %}
        </div>

        <div>
          {{ form.message.label_tag }}
          {{ form.message|add_class:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded" }}
          {% if form.message.errors %}
            <p class="text-red-500 text-sm">{{ form.message.errors.0 }}</p>
          {% endif %}
        </div>

        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded">
          Submit Comment
        </button>
      </form>
    </div>

  </section>
{% endblock %}
